var Resize=function(a,b,c,d,f,g){this.area=a;this.top=b;this.bottom=c;this.bar=d;this.barGrip=f;this.direction=g;this.DRAG_BUFFER_SIZE=4;this.resizeStarted=this.resizeActive=!1;this.resizeStartPos=0;f.addEventListener("mousedown",this._mouseDown.bind(this));f.addEventListener("touchstart",this._touchDown.bind(this))};Resize.prototype._mouseDown=function(a){this._mouse(this._down.bind(this),a)};Resize.prototype._mouseMove=function(a){this._mouse(this._move.bind(this),a)};
Resize.prototype._mouseUp=function(a){this._mouse(this._up.bind(this),a)};Resize.prototype._touchDown=function(a){this._touch(this._down.bind(this),a)};Resize.prototype._touchMove=function(a){this._touch(this._move.bind(this),a)};Resize.prototype._touchUp=function(a){this._touch(this._up.bind(this),a)};Resize.prototype._mouse=function(a,b){return"C"===this.direction?this._eventCaller(a,b,b.pageY):this._eventCaller(a,b,b.pageX)};
Resize.prototype._touch=function(a,b){return"C"===this.direction?this._eventCaller(a,b,b.touches[0].pageY):this._eventCaller(a,b,b.touches[0].pageX)};Resize.prototype._eventCaller=function(a,b,c){if(a(c))return!0;b.preventDefault();return!1};
Resize.prototype._down=function(a){this.resizeStarted=!0;this.resizeStartPos=a;document.addEventListener("mouseup",this._mouseUp.bind(this));document.addEventListener("touchend",this._touchUp.bind(this));document.addEventListener("mousemove",this._mouseMove.bind(this));document.addEventListener("touchmove",this._touchMove.bind(this));return!1};
Resize.prototype._move=function(a){if(this.resizeStarted&&(this.resizeStartPos<a-this.DRAG_BUFFER_SIZE||this.resizeStartPos>a+this.DRAG_BUFFER_SIZE)){this.resizeActive=!0;try{e.target.setCapture()}catch(b){"catch resize e.target.setCapture()"}}this.resizeActive&&this._setTopHeight(this._calulateTopHeight(a));if(this.resizeStarted||this.resizeActive)return!1};
Resize.prototype._up=function(a){var b=!1;this.resizeActive&&this._setTopHeight(this._calulateTopHeight(a));if(this.resizeStarted||this.resizeActive)b=!0;this.resizeStarted=this.resizeActive=!1;document.removeEventListener("mouseup",this._mouseUp.bind(this));document.removeEventListener("touchend",this._touchUp.bind(this));document.removeEventListener("mousemove",this._mouseMove.bind(this));document.removeEventListener("touchmove",this._touchMove.bind(this));if(b){try{document.releaseCapture()}catch(c){console.log("catch resize document.releaseCapture()")}return!1}};
Resize.prototype._calulateTopHeight=function(a){return this._getRelEventY(a)/this._getClientHeight()*100+"%"};Resize.prototype._getRelEventY=function(a){return"C"===this.direction?a-(this.area.getBoundingClientRect().top+this.area.clientTop):a-(this.area.getBoundingClientRect().left+this.area.clientLeft)};Resize.prototype._getClientHeight=function(){return"C"===this.direction?this.area.clientHeight:this.area.clientWidth};
Resize.prototype._setTopHeight=function(a){"C"===this.direction?this.top.style.height=a:this.top.style.width=a};var PaneLayout=function(a,b){this.containerElement=a;this._paneStuff=new _PaneStuff(a);a=this._paneStuff.addPane(b,this._renderPane(b));this._paneStuff.put_floating(a)};PaneLayout.prototype.addPane=function(a,b,c){};PaneLayout.prototype.addPane_unrendered=function(a){};
PaneLayout.prototype.addPane_split=function(a,b,c){a=this._paneStuff.addPane(a,this._renderPane(a));this._paneStuff.put_split(a,b,c)};PaneLayout.prototype.addPane_splitWith=function(a,b,c){this.addPane_split(a,this._paneStuff._panes[b].domRef,c)};PaneLayout.prototype.addPane_splitIntoTab=function(a,b){};PaneLayout.prototype.addPane_splitIntoTabWith=function(a,b){};PaneLayout.prototype.addPane_addToTabs=function(a,b){};PaneLayout.prototype.addPane_addToTabsWith=function(a,b){};
PaneLayout.prototype._renderPane=function(a){a=a.render();if("string"===typeof a){var b=document.createElement("div");b.innerHTML=a;a=b}return a};var _PaneStuff=function(a){this._containerElement=a;this._panes={};this._panesNextKey=0;this._containerElement.style.position="relative";this._containerElement.innerHTML=""};
_PaneStuff.prototype.addPane=function(a,b){b.setAttribute("data-paneLayout-key",this._panesNextKey);b.setAttribute("data-paneLayout-is","pane");a.setKey(this._panesNextKey);this._panes[this._panesNextKey]={el:b,pane:a};return this._panesNextKey++};_PaneStuff.prototype.deletePane=function(a){delete this._panes[a]};_PaneStuff.prototype._make_floater=function(a){var b=document.createElement("div");b.appendChild(a);return b};
_PaneStuff.prototype._make_split=function(a,b,c){var d=document.createElement("div");d.setAttribute("data-paneLayout-is","split");d.classList.add("paneLayout-split");d.classList.add("paneLayout-split"+c);var f=document.createElement("div"),g=document.createElement("div"),h=document.createElement("div"),k=document.createElement("div");f.classList.add("paneLayout-split-top");f.classList.add("paneLayout-split"+c+"-top");f.appendChild(a);g.classList.add("paneLayout-split-bottom");g.classList.add("paneLayout-split"+
c+"-bottom");g.appendChild(b);h.classList.add("paneLayout-split-bar");h.classList.add("paneLayout-split"+c+"-bar");k.classList.add("paneLayout-split-barGrip");k.classList.add("paneLayout-split"+c+"-barGrip");h.appendChild(k);d.appendChild(f);d.appendChild(h);d.appendChild(g);new Resize(d,f,g,h,k,c);return d};
_PaneStuff.prototype._getElFromDomRef=function(a,b,c){b=void 0===b?0:b;c=void 0===c?null:c;var d=null;0===b?d=this._containerElement.children[a[0]].firstChild:"split"===c.getAttribute("data-paneLayout-is")&&("0"===a[b]?d=c.children[0].firstChild:"1"===a[b]&&(d=c.children[2].firstChild));return b===a.length-1?d:this._getElFromDomRef(a,b+1,d)};_PaneStuff.prototype.put_floating=function(a){this._panes[a].domRef=String(this._containerElement.children.length);a=this._make_floater(this._panes[a].el);this._containerElement.appendChild(a)};
_PaneStuff.prototype.put_replace=function(a,b){this._layoutRefDigger(otherPaneLayoutRef)[otherPaneLayoutRef[otherPaneLayoutRef.length-1]]={is:"pane",pane:a}};
_PaneStuff.prototype.put_split=function(a,b,c,d){d=void 0===d?"top":d;if("top"!==d&&"bottom"!==d)throw console.log(d),new Exception("topOrBottom cannot be '"+d+"'");var f=this._getElFromDomRef(b),g=f.getAttribute("data-paneLayout-key"),h=f.parentElement,k=document.createElement("div");h.replaceChild(k,f);this._panes[a].domRef=String(b)+("top"===d?"0":"1");g&&(this._panes[g].domRef=String(b)+("top"===d?"1":"0"));a=this._make_split(this._panes[a].el,f,c);h.replaceChild(a,k)};
_PaneStuff.prototype.put_tabbed=function(a,b){var c=this._layoutRefDigger(b);b=b[b.length-1];newTabed=[c[b],{is:"pane",pane:a}];newTabed.is="tabbed";newTabed.direction=splitDirection;c[b]=newTabed};_PaneStuff.prototype.put_inTabbed=function(a,b){this._layoutRefDigger(b)[b[b.length-1]].push({is:"pane",pane:a})};_PaneStuff.prototype._layoutRefDigger=function(a,b,c){b=void 0===b?0:b;c=void 0===c?null:c;null===c&&(c=this._paneLayout);return a.length-1===b?c:digger(a,b+1,c[a[b]])};
var Resize=function(a,b,c,d,f,g){this.area=a;this.top=b;this.bottom=c;this.bar=d;this.barGrip=f;this.direction=g;this.DRAG_BUFFER_SIZE=4;this.resizeStarted=this.resizeActive=!1;this.resizeStartPos=0;f.addEventListener("mousedown",this._mouseDown.bind(this));f.addEventListener("touchstart",this._touchDown.bind(this))};Resize.prototype._mouseDown=function(a){this._mouse(this._down.bind(this),a)};Resize.prototype._mouseMove=function(a){this._mouse(this._move.bind(this),a)};
Resize.prototype._mouseUp=function(a){this._mouse(this._up.bind(this),a)};Resize.prototype._touchDown=function(a){this._touch(this._down.bind(this),a)};Resize.prototype._touchMove=function(a){this._touch(this._move.bind(this),a)};Resize.prototype._touchUp=function(a){this._touch(this._up.bind(this),a)};Resize.prototype._mouse=function(a,b){return"C"===this.direction?this._eventCaller(a,b,b.pageY):this._eventCaller(a,b,b.pageX)};
Resize.prototype._touch=function(a,b){return"C"===this.direction?this._eventCaller(a,b,b.touches[0].pageY):this._eventCaller(a,b,b.touches[0].pageX)};Resize.prototype._eventCaller=function(a,b,c){if(a(c))return!0;b.preventDefault();return!1};
Resize.prototype._down=function(a){this.resizeStarted=!0;this.resizeStartPos=a;document.addEventListener("mouseup",this._mouseUp.bind(this));document.addEventListener("touchend",this._touchUp.bind(this));document.addEventListener("mousemove",this._mouseMove.bind(this));document.addEventListener("touchmove",this._touchMove.bind(this));return!1};
Resize.prototype._move=function(a){if(this.resizeStarted&&(this.resizeStartPos<a-this.DRAG_BUFFER_SIZE||this.resizeStartPos>a+this.DRAG_BUFFER_SIZE)){this.resizeActive=!0;try{e.target.setCapture()}catch(b){"catch resize e.target.setCapture()"}}this.resizeActive&&this._setTopHeight(this._calulateTopHeight(a));if(this.resizeStarted||this.resizeActive)return!1};
Resize.prototype._up=function(a){var b=!1;this.resizeActive&&this._setTopHeight(this._calulateTopHeight(a));if(this.resizeStarted||this.resizeActive)b=!0;this.resizeStarted=this.resizeActive=!1;document.removeEventListener("mouseup",this._mouseUp.bind(this));document.removeEventListener("touchend",this._touchUp.bind(this));document.removeEventListener("mousemove",this._mouseMove.bind(this));document.removeEventListener("touchmove",this._touchMove.bind(this));if(b){try{document.releaseCapture()}catch(c){console.log("catch resize document.releaseCapture()")}return!1}};
Resize.prototype._calulateTopHeight=function(a){return this._getRelEventY(a)/this._getClientHeight()*100+"%"};Resize.prototype._getRelEventY=function(a){return"C"===this.direction?a-(this.area.getBoundingClientRect().top+this.area.clientTop):a-(this.area.getBoundingClientRect().left+this.area.clientLeft)};Resize.prototype._getClientHeight=function(){return"C"===this.direction?this.area.clientHeight:this.area.clientWidth};
Resize.prototype._setTopHeight=function(a){"C"===this.direction?this.top.style.height=a:this.top.style.width=a};var PaneLayout=function(a,b){this.containerElement=a;this._paneStuff=new _PaneStuff(a);a=this._paneStuff.addPane(b,this._renderPane(b));this._paneStuff.put_floating(a)};PaneLayout.prototype.addPane=function(a,b,c){};PaneLayout.prototype.addPane_unrendered=function(a){};
PaneLayout.prototype.addPane_split=function(a,b,c){a=this._paneStuff.addPane(a,this._renderPane(a));this._paneStuff.put_split(a,b,c)};PaneLayout.prototype.addPane_splitWith=function(a,b,c){this.addPane_split(a,this._paneStuff._panes[b].domRef,c)};PaneLayout.prototype.addPane_splitIntoTab=function(a,b){};PaneLayout.prototype.addPane_splitIntoTabWith=function(a,b){};PaneLayout.prototype.addPane_addToTabs=function(a,b){};PaneLayout.prototype.addPane_addToTabsWith=function(a,b){};
PaneLayout.prototype._renderPane=function(a){a=a.render();if("string"===typeof a){var b=document.createElement("div");b.innerHTML=a;a=b}return a};var _PaneStuff=function(a){this._containerElement=a;this._panes={};this._panesNextKey=0;this._containerElement.style.position="relative";this._containerElement.innerHTML=""};
_PaneStuff.prototype.addPane=function(a,b){b.setAttribute("data-paneLayout-key",this._panesNextKey);b.setAttribute("data-paneLayout-is","pane");a.setKey(this._panesNextKey);this._panes[this._panesNextKey]={el:b,pane:a};return this._panesNextKey++};_PaneStuff.prototype.deletePane=function(a){delete this._panes[a]};_PaneStuff.prototype._make_floater=function(a){var b=document.createElement("div");b.appendChild(a);return b};
_PaneStuff.prototype._make_split=function(a,b,c){var d=document.createElement("div");d.setAttribute("data-paneLayout-is","split");d.classList.add("paneLayout-split");d.classList.add("paneLayout-split"+c);var f=document.createElement("div"),g=document.createElement("div"),h=document.createElement("div"),k=document.createElement("div");f.classList.add("paneLayout-split-top");f.classList.add("paneLayout-split"+c+"-top");f.appendChild(a);g.classList.add("paneLayout-split-bottom");g.classList.add("paneLayout-split"+
c+"-bottom");g.appendChild(b);h.classList.add("paneLayout-split-bar");h.classList.add("paneLayout-split"+c+"-bar");k.classList.add("paneLayout-split-barGrip");k.classList.add("paneLayout-split"+c+"-barGrip");h.appendChild(k);d.appendChild(f);d.appendChild(h);d.appendChild(g);new Resize(d,f,g,h,k,c);return d};
_PaneStuff.prototype._getElFromDomRef=function(a,b,c){b=void 0===b?0:b;c=void 0===c?null:c;var d=null;0===b?d=this._containerElement.children[a[0]].firstChild:"split"===c.getAttribute("data-paneLayout-is")&&("0"===a[b]?d=c.children[0].firstChild:"1"===a[b]&&(d=c.children[2].firstChild));return b===a.length-1?d:this._getElFromDomRef(a,b+1,d)};_PaneStuff.prototype.put_floating=function(a){this._panes[a].domRef=String(this._containerElement.children.length);a=this._make_floater(this._panes[a].el);this._containerElement.appendChild(a)};
_PaneStuff.prototype.put_replace=function(a,b){this._layoutRefDigger(otherPaneLayoutRef)[otherPaneLayoutRef[otherPaneLayoutRef.length-1]]={is:"pane",pane:a}};
_PaneStuff.prototype.put_split=function(a,b,c,d){d=void 0===d?"top":d;if("top"!==d&&"bottom"!==d)throw console.log(d),new Exception("topOrBottom cannot be '"+d+"'");var f=this._getElFromDomRef(b),g=f.getAttribute("data-paneLayout-key"),h=f.parentElement,k=document.createElement("div");h.replaceChild(k,f);this._panes[a].domRef=String(b)+("top"===d?"0":"1");g&&(this._panes[g].domRef=String(b)+("top"===d?"1":"0"));a=this._make_split(this._panes[a].el,f,c);h.replaceChild(a,k)};
_PaneStuff.prototype.put_tabbed=function(a,b){var c=this._layoutRefDigger(b);b=b[b.length-1];newTabed=[c[b],{is:"pane",pane:a}];newTabed.is="tabbed";newTabed.direction=splitDirection;c[b]=newTabed};_PaneStuff.prototype.put_inTabbed=function(a,b){this._layoutRefDigger(b)[b[b.length-1]].push({is:"pane",pane:a})};_PaneStuff.prototype._layoutRefDigger=function(a,b,c){b=void 0===b?0:b;c=void 0===c?null:c;null===c&&(c=this._paneLayout);return a.length-1===b?c:digger(a,b+1,c[a[b]])};
